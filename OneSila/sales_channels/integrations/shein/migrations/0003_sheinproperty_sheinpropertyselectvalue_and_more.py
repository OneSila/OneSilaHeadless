# Generated by Django 5.2 on 2025-11-12 11:35

import core.models.core
import dirtyfields.dirtyfields
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0010_multitenantcompany_active_and_more'),
        ('properties', '0018_alter_productpropertiesrule_unique_together_and_more'),
        ('sales_channels', '0050_populate_saleschannelgptfeed'),
        ('shein', '0002_sheinremotemarketplace_sheinsaleschannelview_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='SheinProperty',
            fields=[
                ('remoteproperty_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='sales_channels.remoteproperty')),
                ('name', models.CharField(blank=True, default='', help_text='Localized attribute name returned by Shein.', max_length=255)),
                ('name_en', models.CharField(blank=True, default='', help_text='English attribute name returned by Shein.', max_length=255)),
                ('value_mode', models.CharField(choices=[('manual_integer', 'Manual positive integer input'), ('multi_select', 'Dropdown multi-select'), ('sales_single_select', 'Sales attribute single select'), ('single_select', 'Single select'), ('multi_select_with_custom', 'Multi-select with custom input')], default='single_select', help_text='Input mode Shein expects for this attribute.', max_length=32)),
                ('value_limit', models.PositiveIntegerField(blank=True, help_text='Maximum number of selectable values when applicable.', null=True)),
                ('attribute_source', models.IntegerField(blank=True, help_text='Source flag reported by Shein.', null=True)),
                ('data_dimension', models.IntegerField(blank=True, help_text='Data dimension flag returned by Shein.', null=True)),
                ('business_mode', models.IntegerField(blank=True, help_text='Business mode flag describing how the attribute is used.', null=True)),
                ('is_sample', models.BooleanField(default=False, help_text='Marks whether the attribute belongs to sample metadata.')),
                ('supplier_id', models.CharField(blank=True, default='', help_text='Supplier identifier when Shein scopes the attribute to a supplier.', max_length=64)),
                ('attribute_doc', models.TextField(blank=True, default='', help_text='Markdown/HTML documentation snippet returned by Shein.')),
                ('attribute_doc_images', models.JSONField(blank=True, default=list, help_text='Image references associated with the attribute documentation.')),
                ('allows_unmapped_values', models.BooleanField(default=False, help_text='Whether merchants can submit custom attribute values for this attribute.')),
                ('type', models.CharField(choices=[('INT', 'Integer'), ('FLOAT', 'Float'), ('TEXT', 'Text'), ('DESCRIPTION', 'Description'), ('BOOLEAN', 'Boolean'), ('DATE', 'Date'), ('DATETIME', 'Date time'), ('SELECT', 'Select'), ('MULTISELECT', 'Multi Select')], default='TEXT', help_text='Mapped internal property type derived from Shein metadata.', max_length=16)),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Original attribute payload returned by Shein.')),
            ],
            options={
                'verbose_name': 'Shein Property',
                'verbose_name_plural': 'Shein Properties',
            },
            bases=('sales_channels.remoteproperty',),
        ),
        migrations.CreateModel(
            name='SheinPropertySelectValue',
            fields=[
                ('remotepropertyselectvalue_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='sales_channels.remotepropertyselectvalue')),
                ('value', models.CharField(blank=True, default='', help_text='Localized attribute value returned by Shein.', max_length=512)),
                ('value_en', models.CharField(blank=True, default='', help_text='English translation for the attribute value.', max_length=512)),
                ('is_custom_value', models.BooleanField(default=False, help_text='True when Shein marks the value as user defined.')),
                ('is_visible', models.BooleanField(default=True, help_text='Visibility flag returned by Shein for the value.')),
                ('supplier_id', models.CharField(blank=True, default='', help_text='Supplier identifier for scoped attribute values.', max_length=64)),
                ('documentation', models.TextField(blank=True, default='', help_text='Optional documentation snippet returned for the value.')),
                ('documentation_images', models.JSONField(blank=True, default=list, help_text='Image references associated with the value documentation.')),
                ('group_data', models.JSONField(blank=True, default=list, help_text='Grouping metadata returned by Shein.')),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Original attribute value payload returned by Shein.')),
            ],
            options={
                'verbose_name': 'Shein Property Select Value',
                'verbose_name_plural': 'Shein Property Select Values',
                'abstract': False,
                'base_manager_name': 'objects',
            },
            bases=('sales_channels.remotepropertyselectvalue',),
        ),
        migrations.CreateModel(
            name='SheinSalesChannelImport',
            fields=[
                ('saleschannelimport_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='sales_channels.saleschannelimport')),
                ('type', models.CharField(choices=[('schema', 'Schema'), ('products', 'Products')], max_length=32)),
            ],
            options={
                'verbose_name': 'Shein Sales Channel Import',
                'verbose_name_plural': 'Shein Sales Channel Imports',
            },
            bases=('sales_channels.saleschannelimport',),
        ),
        migrations.RemoveField(
            model_name='sheinsaleschannelview',
            name='marketplace',
        ),
        migrations.RemoveField(
            model_name='sheinremotecurrency',
            name='sales_channel_view',
        ),
        migrations.CreateModel(
            name='SheinCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('remote_id', models.CharField(help_text='Identifier returned by Shein for this category.', max_length=255)),
                ('site_remote_id', models.CharField(blank=True, default='', help_text='Marketplace/site identifier associated with this category tree.', max_length=64)),
                ('parent_remote_id', models.CharField(blank=True, default='', help_text='Identifier of the parent category according to Shein.', max_length=255)),
                ('name', models.CharField(blank=True, default='', help_text='Display name for the category.', max_length=255)),
                ('is_leaf', models.BooleanField(default=False, help_text='True when Shein marks the category as a last category.')),
                ('product_type_remote_id', models.CharField(blank=True, default='', help_text='Product type identifier associated with the category, if any.', max_length=255)),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Original payload returned by Shein for this category (without children).')),
                ('default_language', models.CharField(blank=True, default='', help_text='Default mandatory language configured by Shein for this category.', max_length=16)),
                ('currency', models.CharField(blank=True, default='', help_text='Currency that Shein expects for supply prices in this category.', max_length=16)),
                ('reference_info_required', models.BooleanField(default=False, help_text='Indicates whether Shein marks the reference info module as required for publishing.')),
                ('reference_product_link_required', models.BooleanField(default=False, help_text='Indicates whether a competitor product link is mandatory when publishing.')),
                ('proof_of_stock_required', models.BooleanField(default=False, help_text='Indicates whether proof of stock is mandatory when publishing.')),
                ('shelf_require_required', models.BooleanField(default=False, help_text='Indicates whether shelf requirements must be provided when publishing.')),
                ('brand_code_required', models.BooleanField(default=False, help_text='Indicates whether a brand code is mandatory when publishing.')),
                ('skc_title_required', models.BooleanField(default=False, help_text='Indicates whether the SKC title is mandatory when publishing.')),
                ('minimum_stock_quantity_required', models.BooleanField(default=False, help_text='Indicates whether a minimum stock quantity is mandatory when publishing.')),
                ('product_detail_picture_required', models.BooleanField(default=False, help_text='Indicates whether detailed product images are mandatory when publishing.')),
                ('quantity_info_required', models.BooleanField(default=False, help_text='Indicates whether SKU quantity information must be provided when publishing.')),
                ('sample_spec_required', models.BooleanField(default=False, help_text='Indicates whether sample information is mandatory when publishing.')),
                ('picture_config', models.JSONField(blank=True, default=list, help_text='Picture configuration flags returned by Shein for this category.')),
                ('parent', models.ForeignKey(blank=True, help_text='Reference to the parent category node when available.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='shein.sheincategory')),
            ],
            options={
                'verbose_name': 'Shein Category',
                'verbose_name_plural': 'Shein Categories',
            },
        ),
        migrations.CreateModel(
            name='SheinInternalProperty',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('remote_id', models.CharField(blank=True, help_text='ID of the object in the remote system', max_length=255, null=True)),
                ('successfully_created', models.BooleanField(default=True, help_text='Indicates if the object was successfully created in the remote system.')),
                ('outdated', models.BooleanField(default=False, help_text='Indicates if the remote product is outdated due to an error.')),
                ('outdated_since', models.DateTimeField(blank=True, help_text='Timestamp indicating when the object became outdated.', null=True)),
                ('code', models.CharField(help_text='Shein internal field identifier (e.g. brand_code).', max_length=255)),
                ('name', models.CharField(help_text='Human readable label for the field.', max_length=255)),
                ('type', models.CharField(choices=[('INT', 'Integer'), ('FLOAT', 'Float'), ('TEXT', 'Text'), ('DESCRIPTION', 'Description'), ('BOOLEAN', 'Boolean'), ('DATE', 'Date'), ('DATETIME', 'Date time'), ('SELECT', 'Select'), ('MULTISELECT', 'Multi Select')], default='TEXT', help_text='Mapped internal property type for this field.', max_length=16)),
                ('is_root', models.BooleanField(default=False, help_text='True when the value lives at the root of the payload.')),
                ('payload_field', models.CharField(blank=True, default='', help_text='Field name used when constructing the Shein payload.', max_length=255)),
                ('created_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('last_update_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_last_update_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('local_instance', models.ForeignKey(blank=True, help_text='Local property associated with this Shein field.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='properties.property')),
                ('multi_tenant_company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='core.multitenantcompany')),
                ('sales_channel', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='sales_channels.saleschannel')),
            ],
            options={
                'verbose_name': 'Shein Internal Property',
                'verbose_name_plural': 'Shein Internal Properties',
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, core.models.core.GetAbsoluteURLMixin, models.Model),
        ),
        migrations.CreateModel(
            name='SheinInternalPropertyOption',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('value', models.CharField(help_text='Remote enumeration value expected by Shein.', max_length=64)),
                ('label', models.CharField(help_text='Human readable label presented to users.', max_length=255)),
                ('description', models.TextField(blank=True, default='', help_text='Optional description explaining when to use this value.')),
                ('sort_order', models.PositiveIntegerField(default=0, help_text='Display order for this option.')),
                ('is_active', models.BooleanField(default=True, help_text='Deactivate to hide the option without deleting it.')),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Raw payload returned by Shein for this option.')),
                ('created_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('internal_property', models.ForeignKey(help_text='Internal property this option belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='options', to='shein.sheininternalproperty')),
                ('last_update_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_last_update_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('local_instance', models.ForeignKey(blank=True, help_text='Optional link to a local property select value.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='properties.propertyselectvalue')),
                ('multi_tenant_company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='core.multitenantcompany')),
                ('sales_channel', models.ForeignKey(help_text='Sales channel that owns this option.', on_delete=django.db.models.deletion.CASCADE, related_name='internal_property_options', to='shein.sheinsaleschannel')),
            ],
            options={
                'verbose_name': 'Shein Internal Property Option',
                'verbose_name_plural': 'Shein Internal Property Options',
                'ordering': ('sort_order', 'label'),
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, core.models.core.GetAbsoluteURLMixin, models.Model),
        ),
        migrations.CreateModel(
            name='SheinProductType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('remote_id', models.CharField(blank=True, help_text='ID of the object in the remote system', max_length=255, null=True)),
                ('successfully_created', models.BooleanField(default=True, help_text='Indicates if the object was successfully created in the remote system.')),
                ('outdated', models.BooleanField(default=False, help_text='Indicates if the remote product is outdated due to an error.')),
                ('outdated_since', models.DateTimeField(blank=True, help_text='Timestamp indicating when the object became outdated.', null=True)),
                ('category_id', models.CharField(blank=True, default='', help_text='Remote Shein category identifier associated with this product type.', max_length=255)),
                ('name', models.CharField(blank=True, help_text='Human readable name reported by Shein for the category/product type.', max_length=255, null=True)),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Original payload returned by Shein for this product type.')),
                ('imported', models.BooleanField(default=True, help_text='Indicates whether the product type was fetched from Shein.')),
                ('created_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('last_update_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_last_update_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('local_instance', models.ForeignKey(blank=True, help_text='Local product properties rule mapped to this Shein product type.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='properties.productpropertiesrule')),
                ('multi_tenant_company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='core.multitenantcompany')),
                ('sales_channel', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='sales_channels.saleschannel')),
            ],
            options={
                'verbose_name': 'Shein Product Type',
                'verbose_name_plural': 'Shein Product Types',
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, core.models.core.GetAbsoluteURLMixin, models.Model),
        ),
        migrations.CreateModel(
            name='SheinProductTypeItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('remote_id', models.CharField(blank=True, help_text='ID of the object in the remote system', max_length=255, null=True)),
                ('successfully_created', models.BooleanField(default=True, help_text='Indicates if the object was successfully created in the remote system.')),
                ('outdated', models.BooleanField(default=False, help_text='Indicates if the remote product is outdated due to an error.')),
                ('outdated_since', models.DateTimeField(blank=True, help_text='Timestamp indicating when the object became outdated.', null=True)),
                ('visibility', models.CharField(choices=[('display', 'Display to shoppers'), ('hidden', 'Hidden from shoppers')], default='display', help_text='Whether the attribute is shown to shoppers for this product type.', max_length=16)),
                ('attribute_type', models.CharField(choices=[('sales', 'Sales attribute'), ('size', 'Size attribute'), ('composition', 'Composition attribute'), ('common', 'Common attribute')], default='common', help_text='How Shein expects the attribute to be sent in payloads.', max_length=16)),
                ('requirement', models.CharField(choices=[('not_fillable', 'Not fillable'), ('optional', 'Optional'), ('required', 'Required')], default='optional', help_text='Requirement level of the attribute for this product type.', max_length=16)),
                ('is_main_attribute', models.BooleanField(default=False, help_text='True when Shein marks the attribute as the main SKC attribute.')),
                ('allows_unmapped_values', models.BooleanField(default=False, help_text='True when Shein allows custom values for this attribute on the given category.')),
                ('remarks', models.JSONField(blank=True, default=list, help_text='Scenario tags (important/compliance/etc.) associated with the attribute.')),
                ('raw_data', models.JSONField(blank=True, default=dict, help_text='Original attribute configuration payload for this product type.')),
                ('created_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_created_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('last_update_by_multi_tenant_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(class)s_last_update_by_multi_tenant_user_set', to=settings.AUTH_USER_MODEL)),
                ('local_instance', models.ForeignKey(blank=True, help_text='Local product rule item mapped to this Shein attribute, when available.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='properties.productpropertiesruleitem')),
                ('multi_tenant_company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='core.multitenantcompany')),
                ('product_type', models.ForeignKey(help_text='Shein product type linked to this attribute.', on_delete=django.db.models.deletion.CASCADE, related_name='items', to='shein.sheinproducttype')),
                ('sales_channel', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='sales_channels.saleschannel')),
                ('property', models.ForeignKey(help_text='Shein attribute definition referenced by this item.', on_delete=django.db.models.deletion.CASCADE, related_name='product_type_items', to='shein.sheinproperty')),
            ],
            options={
                'verbose_name': 'Shein Product Type Item',
                'verbose_name_plural': 'Shein Product Type Items',
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, core.models.core.GetAbsoluteURLMixin, models.Model),
        ),
        migrations.DeleteModel(
            name='SheinRemoteMarketplace',
        ),
        migrations.AddConstraint(
            model_name='sheincategory',
            constraint=models.UniqueConstraint(fields=('remote_id', 'site_remote_id'), name='unique_shein_category_per_site'),
        ),
        migrations.AddConstraint(
            model_name='sheininternalproperty',
            constraint=models.UniqueConstraint(fields=('sales_channel', 'code'), name='unique_shein_internal_property_code_per_channel'),
        ),
        migrations.AlterUniqueTogether(
            name='sheininternalpropertyoption',
            unique_together={('internal_property', 'value')},
        ),
        migrations.AddConstraint(
            model_name='sheinproducttype',
            constraint=models.UniqueConstraint(condition=models.Q(('remote_id__isnull', False)), fields=('sales_channel', 'remote_id'), name='unique_shein_product_type_per_channel'),
        ),
        migrations.AddConstraint(
            model_name='sheinproducttype',
            constraint=models.UniqueConstraint(condition=models.Q(('category_id__gt', '')), fields=('sales_channel', 'category_id'), name='unique_shein_product_type_per_category'),
        ),
        migrations.AddConstraint(
            model_name='sheinproducttypeitem',
            constraint=models.UniqueConstraint(fields=('product_type', 'property'), name='unique_shein_product_type_attribute'),
        ),
    ]
